apiVersion: apps/v1
kind: Deployment
metadata:
  name: mandy-insights-worker
  namespace: project-m-dev
  labels:
    app: mandy-insights-worker
spec:
  replicas: 1
  selector:
    matchLabels:
      app: mandy-insights-worker
  template:
    metadata:
      labels:
        app: mandy-insights-worker
    spec:
      containers:
        - name: mandy-insights-worker
          image: project-m-mandy-insights-worker:latest
          imagePullPolicy: Never
          env:
            - name: BOOTSTRAP_SERVERS
              value: "kafka-service:9092"
            - name: GROUP_ID
              value: "insights_worker_001"
            - name: WORKER_TOPIC
              value: "topic_projectm_cmd_insights_structure"
            - name: PERSIST_TOPIC
              value: "topic_projectm_cmd_persist"
            - name: PERSIST_URL
              value: "http://mandy-kafka-api:8004/kafka/topic/publish"
            - name: STORE_QUERY_URL
              value: "http://mandy-cb-api:8003/cb/qry"
